<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/styles.css">
    <link rel="stylesheet" href="assets/pages/search.css">
    <title>Forecast Search | Weather Today</title>
</head>

<body>
    <nav>
        <a class="toggle" onclick="toggleMenu();"><img src="assets/menu.svg" alt=""></a>
        <div class="items">
            <a href="index.html" class="item" title="Home">Home</a>
            <a href="search.html" class="item active" title="Get Weather Information of a place">Search</a>
            <a href="today.html" class="item" title="Get today's forecast">Today</a>
            <a href="hourly.html" class="item" title="Get today's detailed, hourly forecast">Detailed</a>
        </div>
    </nav>

    <main>
        <form action="">
            <input placeholder="City Name" id="searchinput" name="q" required autocomplete="off" />
            <button id="searchbutton">Search</button>
        </form>
        <div id="forecast">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; background: none; display: block; shape-rendering: auto;" width="200px" height="200px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                <circle class="rotate-clockwise" cx="50" cy="50" r="32" stroke-width="8" stroke="#06f" stroke-dasharray="50.26548245743669 50.26548245743669" fill="none" stroke-linecap="round"></circle>
                <circle class="rotate-anticlockwise" cx="50" cy="50" r="23" stroke-width="8" stroke="#cccccc" stroke-dasharray="36.12831551628262 36.12831551628262" stroke-dashoffset="36.12831551628262" fill="none" stroke-linecap="round"></circle>
                <!-- [ldio] generated by https://loading.io/ -->
            </svg>
        </div>
    </main>

    <script src="assets/script.js"></script>
    <script>
        const searchBox = document.getElementById("searchinput");
        const searchBtn = document.getElementById("searchbutton");
        const forecast = document.getElementById("forecast");
        const q = new URL(window.location.href).searchParams.get("q");
        if (q == null) {
            forecast.innerHTML = ""
        } else {
            searchBox.value = q;
            fetchApi(q).then(data => {
                let forecastData = data.forecast.forecastday[0];
                forecast.innerHTML = `
                    <h2>Weather forecast for ${data.location.name}</h1>
                    <p>
                        Current:<br/>${data.current.temp_c}°C
                    </p>
                    <div class="flex">
                        <p>
                            Minimum:<br/>${forecastData.day.mintemp_c}°C
                        </p>
                        <p>
                            Maximum:<br/>${forecastData.day.maxtemp_c}°C
                        </p>
                    </div>
                    <img src='${data.current.condition.icon}' alt='' />
                    <div class="flex">
                        <p>
                            Sunrise:<br/>${forecastData.astro.sunrise}
                        </p>
                        <p>
                            Sunset:<br/>${forecastData.astro.sunset}
                        </p>
                    </div>
                `
            });
        }

        function setSearch(item) {
            searchBox.value = item;
            searchBtn.click()
        }
    </script>
</body>

</html>